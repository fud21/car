<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ğŸ“¢ ì‹¤ì‹œê°„ ê²½ê³  ì•Œë¦¼</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        h1 {
            font-size: 24px;
        }
        ul {
            padding-left: 1em;
        }
        li {
            margin-bottom: 0.5em;
        }
        #logout {
            margin-top: 20px;
            padding: 6px 12px;
            background-color: crimson;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
    </style>
</head>
<body>
<h1>ğŸ“¢ ì‹¤ì‹œê°„ ê²½ê³  ì•Œë¦¼</h1>

<ul id="log"></ul>

<button id="logout">ë¡œê·¸ì•„ì›ƒ</button>

<script>
    // âœ… ë¡œê·¸ì¸ í† í° í™•ì¸
    const token = localStorage.getItem("token");
    if (!token) {
        alert("ì¸ì¦ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
        location.href = "/login.html";
    }

    // âœ… ì‹¤ì‹œê°„ ê²½ê³  ì•Œë¦¼ ìˆ˜ì‹ 
    const eventSource = new EventSource("/api/warning/stream");
    const log = document.getElementById("log");

    eventSource.addEventListener("warning", function(event) {
        const li = document.createElement("li");
        li.textContent = event.data;
        li.style.color = "crimson";
        li.style.fontWeight = "bold";
        log.appendChild(li);
    });

    eventSource.onerror = function () {
        const li = document.createElement("li");
        li.textContent = "âŒ ì‹¤ì‹œê°„ ì—°ê²° ì¢…ë£Œë¨";
        li.style.color = "gray";
        log.appendChild(li);
    };

    // âœ… ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
    document.getElementById("logout").onclick = () => {
        localStorage.removeItem("token");
        alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
        location.href = "/login.html";
    };
</script>
</body>
</html>
